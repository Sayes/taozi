import{_ as y,d as u,T as f,v as g,x as d,a as r,h as o,o as z,c as m,e as l,f as c}from"./index.9cc46334.js";const v=u({name:"zzjg",components:{ATree:f},computed:{dataProvider(){return()=>this.$daisyCRUDDataProviderFactory.create("basis","zzjg",{event:{afterInitializeRecord:e=>this.afterInitializeRecord(e)},base:{criteria:g(()=>this.criteria)}})},dataProvider1(){return this.$daisyEntityDataManagerFactory.create("basis","zzjg")},criteria(){return this.selectedKeyList.length>0?[{propertyName:"sjzzjgbh",opType:"equals",value:this.selectedKeyList[0]?this.selectedKeyList[0]:null}]:[]}},methods:{afterInitializeRecord(e){return e.sjzzjgbh=this.selectedKeyList[0],e},onLoadData(e){return new Promise(t=>{var i;if((i=e==null?void 0:e.dataRef)!=null&&i.children){t(null);return}e?this.entityDataManager.loadData({currentPage:1,pageSize:0},[{propertyName:"sjzzjgbh",opType:"equals",value:e.dataRef.key?e.dataRef.key:null}]).then(a=>{e.dataRef.children=a.recordList.map(s=>({title:s.jgmc,key:s.jgbh})),this.treeData=[...this.treeData],t(null)}):this.entityDataManager.loadData({currentPage:1,pageSize:0},[{propertyName:"sjzzjgbh",opType:"equals",value:null}]).then(a=>{this.treeData=a.recordList.map(s=>({title:s.jgmc,key:s.jgbh})),a.recordList.length>0&&(this.selectedKeys=[a.recordList[0].jgbh])})})}},mounted(){d(()=>this.treeRef,e=>{this.onLoadData(e.treeData[0])}),d(()=>this.selectedKeyList,(e,t)=>{e.length==0&&t.length>0&&(e[0]=t[0])})},setup(){const e=r([]),t=r([]),i=r([""]),a=r([{title:"\u6839",key:""}]);return{treeRef:e,expandedKeyList:t,selectedKeyList:i,treeData:a}}}),L={style:{display:"flex",height:"100%",width:"100%","flex-direction":"row"}},D={style:{overflow:"hidden auto",padding:"16px",width:"200px",height:"100%",flex:"0 0 auto"}},_={style:{flex:"1 1 auto",height:"100%",position:"relative"}};function j(e,t,i,a,s,K){const p=o("a-tree"),h=o("DaisyCRUD");return z(),m("div",L,[l("div",D,[c(p,{ref:"treeRef",expandedKeyList:e.expandedKeyList,"onUpdate:expandedKeyList":t[0]||(t[0]=n=>e.expandedKeyList=n),selectedKeys:e.selectedKeyList,"onUpdate:selectedKeys":t[1]||(t[1]=n=>e.selectedKeyList=n),"load-data":e.onLoadData,"tree-data":e.treeData,"block-node":!0},null,8,["expandedKeyList","selectedKeys","load-data","tree-data"])]),l("div",_,[c(h,{dataProvider:e.dataProvider},null,8,["dataProvider"])])])}var b=y(v,[["render",j],["__scopeId","data-v-0505deb4"]]);export{b as default};
